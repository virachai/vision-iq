[31m[Nest] 10392  - [39m02/12/2026, 3:32:16 PM [31m  ERROR[39m [38;5;3m[PexelsIntegrationService] [39m[31mPexels API error: undefined Cannot read properties of undefined (reading 'data')[39m
[31m[Nest] 10392  - [39m02/12/2026, 3:32:16 PM [31m  ERROR[39m [38;5;3m[PexelsIntegrationService] [39m[31mPexels sync failed[39m
Cannot read properties of undefined (reading 'data')
[31m[Nest] 10392  - [39m02/12/2026, 3:32:23 PM [31m  ERROR[39m [38;5;3m[PexelsIntegrationService] [39m[31mPexels API error: 429 undefined[39m
[31m[Nest] 10392  - [39m02/12/2026, 3:32:23 PM [31m  ERROR[39m [38;5;3m[PexelsIntegrationService] [39m[31mPexels sync failed[39m
(node:10392) PromiseRejectionHandledWarning: Promise rejection was handled asynchronously (rejection id: 7)
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL src/pexels-sync/pexels-integration.service.spec.ts
  PexelsIntegrationService
    ‚àö should be defined (15 ms)
    syncPexelsLibrary
      √ó should yield batches of images (90 ms)
      ‚àö should handle single page correctly (2 ms)
      ‚àö should respect rate limiting and retry on 429 (3 ms)
      √ó should throw error after max retries (5 ms)

  ‚óè PexelsIntegrationService ‚Ä∫ syncPexelsLibrary ‚Ä∫ should yield batches of images

    TypeError: Cannot read properties of undefined (reading 'data')

    [0m [90m 167 |[39m
     [90m 168 |[39m 			[36mthis[39m[33m.[39mlogger[33m.[39mdebug(
    [31m[1m>[22m[39m[90m 169 |[39m 				[32m`Fetched page ${page} from Pexels (${response.data.photos.length} photos)`[39m[33m,[39m
     [90m     |[39m 				                                              [31m[1m^[22m[39m
     [90m 170 |[39m 			)[33m;[39m
     [90m 171 |[39m 			[36mreturn[39m response[33m.[39mdata[33m;[39m
     [90m 172 |[39m 		} [36mcatch[39m (error) {[0m

      at PexelsIntegrationService.getPexelsPage (src/pexels-sync/pexels-integration.service.ts:169:51)
      at async PexelsIntegrationService.syncPexelsLibrary (src/pexels-sync/pexels-integration.service.ts:114:27)
      at async Object.<anonymous> (src/pexels-sync/pexels-integration.service.spec.ts:77:21)

  ‚óè PexelsIntegrationService ‚Ä∫ syncPexelsLibrary ‚Ä∫ should throw error after max retries

    thrown: Object {
      "response": Object {
        "status": 429,
      },
    }

      at _getError (../../node_modules/.pnpm/jest-circus@29.7.0/node_modules/jest-circus/build/utils.js:432:18)
          at Array.map (<anonymous>)

  ‚óè PexelsIntegrationService ‚Ä∫ syncPexelsLibrary ‚Ä∫ should throw error after max retries

    expect(received).rejects.toThrow()

    Received function did not throw

    [0m [90m 152 |[39m 			[36mawait[39m jest[33m.[39mrunAllTimersAsync()[33m;[39m
     [90m 153 |[39m
    [31m[1m>[22m[39m[90m 154 |[39m 			[36mawait[39m expect(promise)[33m.[39mrejects[33m.[39mtoThrow()[33m;[39m
     [90m     |[39m 			                              [31m[1m^[22m[39m
     [90m 155 |[39m 			[90m// Initial + 3 retries = 4 calls[39m
     [90m 156 |[39m 			expect(mockedAxios[33m.[39m[36mget[39m)[33m.[39mtoHaveBeenCalledTimes([35m4[39m)[33m;[39m
     [90m 157 |[39m[0m

      at Object.toThrow (../../node_modules/.pnpm/expect@29.7.0/node_modules/expect/build/index.js:218:22)
      at Object.<anonymous> (src/pexels-sync/pexels-integration.service.spec.ts:154:34)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 3 passed, 5 total
Snapshots:   0 total
Time:        1.543 s
Ran all test suites matching /src\\pexels-sync\\pexels-integration.service.spec.ts/i.
